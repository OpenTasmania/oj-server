# Configuration for pg_tileserv service
http_host: "0.0.0.0"
http_port: 7800
config_dir: "/etc/pg_tileserv"
config_filename: "config.toml"
system_user: "pg_tileserv"
binary_install_path: "/usr/local/bin/pg_tileserv"
default_max_features: 10000
publish_schemas: "public,postgisftw"
uri_prefix: "/tiles/"
development_mode: false
allow_function_sources: true

config_template: |
  # pg_tileserv config generated by script V{script_hash}
  HttpHost = "{pg_tileserv_http_host}"
  HttpPort = {pg_tileserv_http_port}
  DatabaseURL = "{db_url_for_pg_tileserv}"
  DefaultMaxFeatures = {pg_tileserv_default_max_features}
  PublishSchemas = "{pg_tileserv_publish_schemas}"
  URIPrefix = "{pg_tileserv_uri_prefix}"
  DevelopmentMode = {pg_tileserv_development_mode_bool}
  AllowFunctionSources = {pg_tileserv_allow_function_sources_bool}

systemd_template: |
  [Unit]
  Description=pg_tileserv - Vector Tile Server for PostGIS
  Documentation=https://github.com/CrunchyData/pg_tileserv
  Wants=network-online.target postgresql.service
  After=network-online.target postgresql.service

  [Service]
  User={pg_tileserv_system_user}
  # Assumes group is same as user, or define separately
  Group={pg_tileserv_system_group}
  Environment="DATABASE_URL={pg_tileserv_systemd_environment}"
  ExecStart={pg_tileserv_binary_path} --config {pg_tileserv_config_file_path_systemd}
  Restart=on-failure
  RestartSec=5s
  StandardOutput=journal
  StandardError=journal
  SyslogIdentifier=pg_tileserv

  [Install]
  WantedBy=multi-user.target
  # File created by script V{script_hash}
